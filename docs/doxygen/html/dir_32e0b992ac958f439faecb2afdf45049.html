<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT-muskrattrap: serverSide/nodered/node_modules/compression Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IoT-muskrattrap
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_32e0b992ac958f439faecb2afdf45049.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">compression Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Directory dependency graph for compression:</div>
<div class="dyncontent">
<div class="center"><img src="dir_32e0b992ac958f439faecb2afdf45049_dep.png" border="0" usemap="#adir__32e0b992ac958f439faecb2afdf45049__dep" loading="lazy" alt="serverSide/nodered/node_modules/compression"/></div>
<map name="adir__32e0b992ac958f439faecb2afdf45049__dep" id="adir__32e0b992ac958f439faecb2afdf45049__dep">
<area shape="rect" href="dir_32e0b992ac958f439faecb2afdf45049.html" title="compression" alt="" coords="27,52,122,78"/>
<area shape="rect" href="dir_1fe2c0d618eaa8bd2b6d3d78892e74a8.html" title="node_modules" alt="" coords="16,16,133,89"/>
</map>
</div>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<h1 class="doxsection"><a class="anchor" id="autotoc_md423"></a>
compression</h1>
<p><a href="https://npmjs.org/package/compression"><img src="https://badgen.net/npm/v/compression" alt="NPM Version" class="inline"/></a> <a href="https://npmcharts.com/compare/compression?minimal=true"><img src="https://badgen.net/npm/dm/compression" alt="NPM Downloads" class="inline"/></a> <a href="https://github.com/expressjs/compression/actions?query=workflow%3Aci"><img src="https://badgen.net/github/checks/expressjs/compression/master?label=CI" alt="Build Status" class="inline"/></a> <a href="https://ossf.github.io/scorecard-visualizer/#/projects/github.com/expressjs/compression"><img src="https://api.scorecard.dev/projects/github.com/expressjs/compression/badge" alt="OpenSSF Scorecard Badge" class="inline"/></a> <a href="https://opencollective.com/express"><img src="https://badgen.net/badge/icon/sponsor/pink?icon=github&amp;label=Open%20Collective" alt="Funding" class="inline"/></a></p>
<p>Node.js compression middleware.</p>
<p>The following compression codings are supported:</p>
<ul>
<li>deflate</li>
<li>gzip</li>
<li>br (brotli)</li>
</ul>
<p><b>Note</b> Brotli is supported only since Node.js versions v11.7.0 and v10.16.0.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md424"></a>
Install</h1>
<p>This is a <a href="https://nodejs.org/en/">Node.js</a> module available through the <a href="https://www.npmjs.com/">npm registry</a>. Installation is done using the <a href="https://docs.npmjs.com/getting-started/installing-npm-packages-locally"><span class="tt">npm install</span> command</a>:</p>
<div class="fragment"><div class="line">$ npm install compression</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md425"></a>
API</h1>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md426"></a>
compression([options])</h2>
<p>Returns the compression middleware using the given <span class="tt">options</span>. The middleware will attempt to compress response bodies for all requests that traverse through the middleware, based on the given <span class="tt">options</span>.</p>
<p>This middleware will never compress responses that include a <span class="tt">Cache-Control</span> header with the <a href="https://tools.ietf.org/html/rfc7234#section-5.2.2.4"><span class="tt">no-transform</span> directive</a>, as compressing will transform the body.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md427"></a>
Options</h3>
<p><span class="tt">compression()</span> accepts these properties in the options object. In addition to those listed below, <a href="http://nodejs.org/api/zlib.html">zlib</a> options may be passed in to the options object or <a href="https://nodejs.org/api/zlib.html#zlib_class_brotlioptions">brotli</a> options.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md428"></a>
chunkSize</h4>
<p>Type: <span class="tt">Number</span><br  />
 Default: <span class="tt">zlib.constants.Z_DEFAULT_CHUNK</span>, or <span class="tt">16384</span>.</p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md429"></a>
filter</h4>
<p>Type: <span class="tt">Function</span></p>
<p>A function to decide if the response should be considered for compression. This function is called as <span class="tt">filter(req, res)</span> and is expected to return <span class="tt">true</span> to consider the response for compression, or <span class="tt">false</span> to not compress the response.</p>
<p>The default filter function uses the <a href="https://www.npmjs.com/package/compressible">compressible</a> module to determine if &lsquo;res.getHeader('Content-Type&rsquo;)` is compressible.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md430"></a>
level</h4>
<p>Type: <span class="tt">Number</span><br  />
 Default: <span class="tt">zlib.constants.Z_DEFAULT_COMPRESSION</span>, or <span class="tt">-1</span></p>
<p>The level of zlib compression to apply to responses. A higher level will result in better compression, but will take longer to complete. A lower level will result in less compression, but will be much faster.</p>
<p>This is an integer in the range of <span class="tt">0</span> (no compression) to <span class="tt">9</span> (maximum compression). The special value <span class="tt">-1</span> can be used to mean the "default
compression level", which is a default compromise between speed and compression (currently equivalent to level 6).</p>
<ul>
<li><span class="tt">-1</span> Default compression level (also <span class="tt">zlib.constants.Z_DEFAULT_COMPRESSION</span>).</li>
<li><span class="tt">0</span> No compression (also <span class="tt">zlib.constants.Z_NO_COMPRESSION</span>).</li>
<li><span class="tt">1</span> Fastest compression (also <span class="tt">zlib.constants.Z_BEST_SPEED</span>).</li>
<li><span class="tt">2</span></li>
<li><span class="tt">3</span></li>
<li><span class="tt">4</span></li>
<li><span class="tt">5</span></li>
<li><span class="tt">6</span> (currently what <span class="tt">zlib.constants.Z_DEFAULT_COMPRESSION</span> points to).</li>
<li><span class="tt">7</span></li>
<li><span class="tt">8</span></li>
<li><span class="tt">9</span> Best compression (also <span class="tt">zlib.constants.Z_BEST_COMPRESSION</span>).</li>
</ul>
<p><b>Note</b> in the list above, <span class="tt">zlib</span> is from &lsquo;zlib = require('zlib&rsquo;)`.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md431"></a>
memLevel</h4>
<p>Type: <span class="tt">Number</span><br  />
 Default: <span class="tt">zlib.constants.Z_DEFAULT_MEMLEVEL</span>, or <span class="tt">8</span></p>
<p>This specifies how much memory should be allocated for the internal compression state and is an integer in the range of <span class="tt">1</span> (minimum level) and <span class="tt">9</span> (maximum level).</p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md432"></a>
brotli</h4>
<p>Type: <span class="tt">Object</span></p>
<p>This specifies the options for configuring Brotli. See <a href="https://nodejs.org/api/zlib.html#class-brotlioptions">Node.js documentation</a> for a complete list of available options.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md433"></a>
strategy</h4>
<p>Type: <span class="tt">Number</span><br  />
 Default: <span class="tt">zlib.constants.Z_DEFAULT_STRATEGY</span></p>
<p>This is used to tune the compression algorithm. This value only affects the compression ratio, not the correctness of the compressed output, even if it is not set appropriately.</p>
<ul>
<li><span class="tt">zlib.constants.Z_DEFAULT_STRATEGY</span> Use for normal data.</li>
<li><span class="tt">zlib.constants.Z_FILTERED</span> Use for data produced by a filter (or predictor). Filtered data consists mostly of small values with a somewhat random distribution. In this case, the compression algorithm is tuned to compress them better. The effect is to force more Huffman coding and less string matching; it is somewhat intermediate between <span class="tt">zlib.constants.Z_DEFAULT_STRATEGY</span> and <span class="tt">zlib.constants.Z_HUFFMAN_ONLY</span>.</li>
<li><span class="tt">zlib.constants.Z_FIXED</span> Use to prevent the use of dynamic Huffman codes, allowing for a simpler decoder for special applications.</li>
<li><span class="tt">zlib.constants.Z_HUFFMAN_ONLY</span> Use to force Huffman encoding only (no string match).</li>
<li><span class="tt">zlib.constants.Z_RLE</span> Use to limit match distances to one (run-length encoding). This is designed to be almost as fast as <span class="tt">zlib.constants.Z_HUFFMAN_ONLY</span>, but give better compression for PNG image data.</li>
</ul>
<p><b>Note</b> in the list above, <span class="tt">zlib</span> is from &lsquo;zlib = require('zlib&rsquo;)`.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md434"></a>
threshold</h4>
<p>Type: <span class="tt">Number</span> or <span class="tt">String</span><br  />
 Default: <span class="tt">1kb</span></p>
<p>The byte threshold for the response body size before compression is considered for the response. This is a number of bytes or any string accepted by the <a href="https://www.npmjs.com/package/bytes">bytes</a> module.</p>
<p><b>Note</b> this is only an advisory setting; if the response size cannot be determined at the time the response headers are written, then it is assumed the response is <em>over</em> the threshold. To guarantee the response size can be determined, be sure set a <span class="tt">Content-Length</span> response header.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md435"></a>
windowBits</h4>
<p>Type: <span class="tt">Number</span><br  />
 Default: <span class="tt">zlib.constants.Z_DEFAULT_WINDOWBITS</span>, or <span class="tt">15</span></p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md436"></a>
enforceEncoding</h4>
<p>Type: <span class="tt">String</span><br  />
 Default: <span class="tt">identity</span></p>
<p>This is the default encoding to use when the client does not specify an encoding in the request's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding">Accept-Encoding</a> header.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md437"></a>
.filter</h3>
<p>The default <span class="tt">filter</span> function. This is used to construct a custom filter function that is an extension of the default function.</p>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div>
<div class="line">var express = require(&#39;express&#39;)</div>
<div class="line"> </div>
<div class="line">var app = express()</div>
<div class="line"> </div>
<div class="line">app.use(compression({ filter: shouldCompress }))</div>
<div class="line"> </div>
<div class="line">function shouldCompress (req, res) {</div>
<div class="line">  if (req.headers[&#39;x-no-compression&#39;]) {</div>
<div class="line">    // don&#39;t compress responses with this request header</div>
<div class="line">    return false</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  // fallback to standard filter function</div>
<div class="line">  return compression.filter(req, res)</div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md438"></a>
res.flush</h2>
<p>This module adds a <span class="tt">res.flush()</span> method to force the partially-compressed response to be flushed to the client.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md439"></a>
Examples</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md440"></a>
express</h2>
<p>When using this module with express, simply <span class="tt">app.use</span> the module as high as you like. Requests that pass through the middleware will be compressed.</p>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div>
<div class="line">var express = require(&#39;express&#39;)</div>
<div class="line"> </div>
<div class="line">var app = express()</div>
<div class="line"> </div>
<div class="line">// compress all responses</div>
<div class="line">app.use(compression())</div>
<div class="line"> </div>
<div class="line">// add all routes</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md441"></a>
Node.js HTTP server</h2>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)({ threshold: 0 })</div>
<div class="line">var http = require(&#39;http&#39;)</div>
<div class="line"> </div>
<div class="line">function createServer (fn) {</div>
<div class="line">  return http.createServer(function (req, res) {</div>
<div class="line">    compression(req, res, function (err) {</div>
<div class="line">      if (err) {</div>
<div class="line">        res.statusCode = err.status || 500</div>
<div class="line">        res.end(err.message)</div>
<div class="line">        return</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fn(req, res)</div>
<div class="line">    })</div>
<div class="line">  })</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">var server = createServer(function (req, res) {</div>
<div class="line">  res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;)</div>
<div class="line">  res.end(&#39;hello world!&#39;)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">server.listen(3000, () =&gt; {</div>
<div class="line">  console.log(&#39;&gt; Listening at http://localhost:3000&#39;)</div>
<div class="line">})</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md442"></a>
Server-Sent Events</h2>
<p>Because of the nature of compression this module does not work out of the box with server-sent events. To compress content, a window of the output needs to be buffered up in order to get good compression. Typically when using server-sent events, there are certain block of data that need to reach the client.</p>
<p>You can achieve this by calling <span class="tt">res.flush()</span> when you need the data written to actually make it to the client.</p>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div>
<div class="line">var express = require(&#39;express&#39;)</div>
<div class="line"> </div>
<div class="line">var app = express()</div>
<div class="line"> </div>
<div class="line">// compress responses</div>
<div class="line">app.use(compression())</div>
<div class="line"> </div>
<div class="line">// server-sent event stream</div>
<div class="line">app.get(&#39;/events&#39;, function (req, res) {</div>
<div class="line">  res.setHeader(&#39;Content-Type&#39;, &#39;text/event-stream&#39;)</div>
<div class="line">  res.setHeader(&#39;Cache-Control&#39;, &#39;no-cache&#39;)</div>
<div class="line"> </div>
<div class="line">  // send a ping approx every 2 seconds</div>
<div class="line">  var timer = setInterval(function () {</div>
<div class="line">    res.write(&#39;data: ping\n\n&#39;)</div>
<div class="line"> </div>
<div class="line">    // !!! this is the important part</div>
<div class="line">    res.flush()</div>
<div class="line">  }, 2000)</div>
<div class="line"> </div>
<div class="line">  res.on(&#39;close&#39;, function () {</div>
<div class="line">    clearInterval(timer)</div>
<div class="line">  })</div>
<div class="line">})</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md443"></a>
Contributing</h1>
<p>The Express.js project welcomes all constructive contributions. Contributions take many forms, from code for bug fixes and enhancements, to additions and fixes to documentation, additional tests, triaging incoming pull requests and issues, and more!</p>
<p>See the <a href="https://github.com/expressjs/express/blob/master/Contributing.md">Contributing Guide</a> for more technical details on contributing.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md444"></a>
License</h1>
<p>[MIT](LICENSE) </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_27880ab04338f9dc09e25838fc9f82f1.html">serverSide</a></li><li class="navelem"><a href="dir_ea245d1371037254a9bc4ef873bc881e.html">nodered</a></li><li class="navelem"><a href="dir_1fe2c0d618eaa8bd2b6d3d78892e74a8.html">node_modules</a></li><li class="navelem"><a href="dir_32e0b992ac958f439faecb2afdf45049.html">compression</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
