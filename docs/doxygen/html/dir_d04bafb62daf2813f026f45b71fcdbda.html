<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT-muskrattrap: serverSide/nodered/node_modules/seq-queue Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IoT-muskrattrap
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_d04bafb62daf2813f026f45b71fcdbda.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">seq-queue Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Directory dependency graph for seq-queue:</div>
<div class="dyncontent">
<div class="center"><img src="dir_d04bafb62daf2813f026f45b71fcdbda_dep.png" border="0" usemap="#adir__d04bafb62daf2813f026f45b71fcdbda__dep" loading="lazy" alt="serverSide/nodered/node_modules/seq-queue"/></div>
<map name="adir__d04bafb62daf2813f026f45b71fcdbda__dep" id="adir__d04bafb62daf2813f026f45b71fcdbda__dep">
<area shape="rect" href="dir_d04bafb62daf2813f026f45b71fcdbda.html" title="seq&#45;queue" alt="" coords="27,52,109,78"/>
<area shape="rect" href="dir_1fe2c0d618eaa8bd2b6d3d78892e74a8.html" title="node_modules" alt="" coords="16,16,121,89"/>
</map>
</div>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Seq-queue is simple tool to keep requests to be executed in order.</p>
<p>As we known, Node.js codes run in asynchronous mode and the callbacks are unordered. But sometimes we may need the requests to be processed in order. For example, in a game, a player would do some operations such as turn right and go ahead. And in the server side, we would like to process these requests one by one, not do them all at the same time.</p>
<p>Seq-queue takes the responsibility to make the asynchronous, unordered processing flow into serial and ordered. It's simple but not a repeated wheel.</p>
<p>Seq-queue is a FIFO task queue and we can push tasks as we wish, anytime(before the queue closed), anywhere(if we hold the queue instance). A task is known as a function and we can do anything in the function and just need to call <span class="tt">task.done()</span> to tell the queue current task has finished. It promises that a task in queue would not be executed util all tasks before it finished.</p>
<p>Seq-queue add timeout for each task execution. If a task throws an uncaught exception in its call back or a developer forgets to call <span class="tt">task.done()</span> callback, queue would be blocked and would not execute the left tasks. To avoid these situations, seq-queue set a timeout for each task. If a task timeout, queue would drop the task and notify develop by a 'timeout' event and then invoke the next task. Any <span class="tt">task.done()</span> invoked in a timeout task would be ignored.</p>
<ul>
<li>Tags: node.js</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1785"></a>
Installation</h1>
<div class="fragment"><div class="line">npm install seq-queue</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md1786"></a>
Usage</h1>
<div class="fragment"><div class="line"> javascript</div>
<div class="line">var seqqueue = require(&#39;seq-queue&#39;);</div>
<div class="line"> </div>
<div class="line">var queue = seqqueue.createQueue(1000);</div>
<div class="line"> </div>
<div class="line">queue.push(</div>
<div class="line">  function(task) {</div>
<div class="line">    setTimeout(function() {</div>
<div class="line">      console.log(&#39;hello &#39;);</div>
<div class="line">      task.done();</div>
<div class="line">    }, 500);</div>
<div class="line">  }, </div>
<div class="line">  function() {</div>
<div class="line">    console.log(&#39;task timeout&#39;);</div>
<div class="line">  }, </div>
<div class="line">  1000</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">queue.push(</div>
<div class="line">  function(task) {</div>
<div class="line">    setTimeout(function() {</div>
<div class="line">      console.log(&#39;world~&#39;);</div>
<div class="line">      task.done();</div>
<div class="line">    }, 500);</div>
<div class="line">  }</div>
<div class="line">);</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md1787"></a>
API</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1788"></a>
seqqueue.createQueue(timeout)</h2>
<p>Create a new queue instance. A global timeout value in ms for the new instance can be set by <span class="tt">timeout</span> parameter or use the default timeout (3s) by no parameter.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1789"></a>
queue.push(fn, ontimeout, timeout)</h2>
<p>Add a task into the queue instance. </p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md1790"></a>
Arguments</h3>
<ul>
<li>fn(task) - The function that describes the content of task and would be invoke by queue. <span class="tt">fn</span> takes a arguemnt task and we <em>must</em> call task.done() to tell queue current task has finished.</li>
<li>ontimeout() - Callback for task timeout.</li>
<li>timeout - Timeout in ms for <span class="tt">fn</span>. If specified, it would overwrite the global timeout that set by <span class="tt">createQueue</span> for <span class="tt">fn</span>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1791"></a>
queue.close(force)</h2>
<p>Close the queue. A closed queue would stop receiving new task immediately. And the left tasks would be treated in different ways decided by <span class="tt">force</span>. </p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md1792"></a>
Arguments</h3>
<ul>
<li>force - If true, queue would stop working immediately and ignore any tasks left in queue. Otherwise queue would execute the tasks in queue and then stop.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1793"></a>
Event</h1>
<p>Seq-queue instances extend the EventEmitter and would emit events in their life cycles. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1794"></a>
'timeout'(totask)</h2>
<p>If current task not invoke task.done() within the timeout ms, a timeout event would be emit. totask.fn and totask.timeout is the <span class="tt">fn</span> and <span class="tt">timeout</span> arguments that passed by <span class="tt">queue.push(2)</span>. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1795"></a>
'error'(err, task)</h2>
<p>If the task function (not callbacks) throws an uncaught error, queue would emit an error event and passes the err and task informations by event callback arguments. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1796"></a>
'closed'</h2>
<p>Emit when the close(false) is invoked. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1797"></a>
'drained'</h2>
<p>Emit when close(true) is invoked or all tasks left have finished in closed status. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_27880ab04338f9dc09e25838fc9f82f1.html">serverSide</a></li><li class="navelem"><a href="dir_ea245d1371037254a9bc4ef873bc881e.html">nodered</a></li><li class="navelem"><a href="dir_1fe2c0d618eaa8bd2b6d3d78892e74a8.html">node_modules</a></li><li class="navelem"><a href="dir_d04bafb62daf2813f026f45b71fcdbda.html">seq-queue</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
